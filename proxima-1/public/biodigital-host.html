<!DOCTYPE html>
<html style="height: 100%; margin: 0;">
<head>
    <title>BioDigital Human Host</title>
    <style>
        body {
            height: 100%;
            margin: 0;
            overflow: hidden;
            background: #000;
        }
        #status {
            position: absolute;
            top: 10px;
            left: 10px;
            color: #0f0;
            font-family: monospace;
            z-index: 1000;
            background: rgba(0,0,0,0.8);
            padding: 10px;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div id="status">Initializing...</div>
    
    <iframe 
        id="biodigital-iframe" 
        src="https://human.biodigital.com/viewer/?id=6JJy&ui-anatomy-descriptions=true&ui-anatomy-pronunciations=true&ui-anatomy-labels=false&ui-audio=false&ui-chapter-list=false&ui-fullscreen=false&ui-help=false&ui-info=false&ui-label-list=true&ui-layers=false&ui-skin-layers=false&ui-loader=circle&ui-media-controls=none&ui-menu=false&ui-nav=false&ui-search=false&ui-tools=false&ui-tutorial=false&ui-undo=false&ui-whiteboard=false&initial.none=true&disable-scroll=false&uaid=M9yqM&paid=o_14daca03&dk=4a7eb63719c66a365c746afeae476870503ba4be"
        width="100%" 
        height="100%"
        frameborder="0"
        style="border: none;">
    </iframe>
    
    <script src="https://human-api.biodigital.com/build/1.2.1/human-api-1.2.1.min.js"></script>
    
    <script>
        let status = document.getElementById('status');
        
        function log(msg) {
            console.log(msg);
            status.innerHTML += '<br>' + msg;
        }
        
        window.addEventListener('load', function() {
            log('Page loaded, waiting for SDK...');
            
            setTimeout(function() {
                if (typeof HumanAPI === 'undefined') {
                    log('ERROR: HumanAPI not loaded');
                    return;
                }
                
                log('SDK loaded, initializing Human...');
                
                try {
                    var human = new HumanAPI.Human('biodigital-iframe', {
                        developerKey: '4a7eb63719c66a365c746afeae476870503ba4be'
                    });
                    
                    human.on('ready', function() {
                        log('âœ“ BioDigital Human READY!');
                        
                        // Set up pick handler
                        human.pick.on('picked', function(event) {
                            log('PICKED: ' + (event.object?.displayName || event.objectId));
                            
                            // Send to parent window
                            window.parent.postMessage({
                                type: 'BIODIGITAL_PICK',
                                data: {
                                    objectName: event.object?.displayName || event.object?.name,
                                    objectId: event.objectId,
                                    worldPos: event.worldPos,
                                    screenPos: event.screenPos
                                }
                            }, '*');
                        });
                        
                        log('Pick handler registered');
                    });
                    
                    human.on('error', function(err) {
                        log('ERROR: ' + JSON.stringify(err));
                    });
                    
                } catch (e) {
                    log('EXCEPTION: ' + e.message);
                }
            }, 3000);
        });
    </script>
</body>
</html>